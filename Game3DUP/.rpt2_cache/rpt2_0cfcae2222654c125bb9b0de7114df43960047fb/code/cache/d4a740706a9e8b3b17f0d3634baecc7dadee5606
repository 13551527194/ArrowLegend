{
  "code": "import { ui } from \"../../../../ui/layaMaxUI\";\r\nimport Session from \"../../../Session\";\r\nimport SysRoleUp from \"../../../sys/SysRoleUp\";\r\nimport { HeroLvType } from \"../../../../game/data/HeroData\";\r\nimport SysRoleBase from \"../../../sys/SysRolebase\";\r\nimport App from \"../../../../core/App\";\r\nimport AdDiamond from \"../../../dialog/AdDiamond\";\r\nimport AutoEvent from \"../../../../core/utils/AutoEvent\";\r\nimport GameEvent from \"../../../GameEvent\";\r\nimport SysSkill from \"../../../sys/SysSkill\";\r\nimport { GoldType } from \"../../../../game/data/HomeData\";\r\nexport default class RoleView extends ui.test.jueseUI {\r\n    constructor() {\r\n        super();\r\n        this.nowRoleId = 1;\r\n        this.autoEvent = new AutoEvent();\r\n        this.autoEvent.setSprite(this);\r\n        this.shengmingniu.clickHandler = new Laya.Handler(this, this.hpFun);\r\n        this.gongjiniu.clickHandler = new Laya.Handler(this, this.atkFun);\r\n        this.updateAll();\r\n        this.on(Laya.Event.DISPLAY, this, this.disFun);\r\n        this.jia.clickHandler = new Laya.Handler(this, this.jiaFun, [GoldType.RED_DIAMONG]);\r\n        this.jia2.clickHandler = new Laya.Handler(this, this.jiaFun, [GoldType.BLUE_DIAMONG]);\r\n        this.autoEvent.onEvent(GameEvent.GOLD_CHANGE, this, this.goldChangeFun);\r\n        this.autoEvent.onEvent(GameEvent.HERO_UPDATE, this, this.heroFun);\r\n    }\r\n    heroFun() {\r\n        this.updateAll();\r\n    }\r\n    goldChangeFun() {\r\n        this.updateAll();\r\n    }\r\n    jiaFun(goldType) {\r\n        let d = new AdDiamond();\r\n        d.setGoldType(goldType);\r\n        d.popup();\r\n    }\r\n    disFun() {\r\n        this.updateAll();\r\n    }\r\n    hpFun() {\r\n        Session.heroData.lvUp(this.nowRoleId, HeroLvType.HP);\r\n    }\r\n    atkFun() {\r\n        Session.heroData.lvUp(this.nowRoleId, HeroLvType.ATK);\r\n    }\r\n    updateAll() {\r\n        this.setOne(this.box1, HeroLvType.HP, this.shengmingniu, this.shengmingjia, this.xueshu, this.tiao, this.shengmingshu);\r\n        this.setOne(this.box2, HeroLvType.ATK, this.gongjiniu, this.gongjijia, this.gongshu, this.tiao2, this.gongjishu);\r\n        let sys = SysRoleBase.getSys(this.nowRoleId);\r\n        let sysSkill = App.tableManager.getDataByNameAndId(SysSkill.NAME, sys.baseSkill);\r\n        this.skillLabel.text = sysSkill.skillInfo;\r\n        this.jinengming.text = sysSkill.skillName;\r\n        this.jinengtubiao.skin = null;\r\n        this.jinengtubiao.skin = \"icons/skill/\" + sysSkill.id + \".png\";\r\n    }\r\n    setOne(box, type, btn, fc, fc2, tiao, allFc) {\r\n        let lv = Session.heroData.getHeroLv(this.nowRoleId, type);\r\n        let sys = SysRoleUp.getSysRole(this.nowRoleId, lv);\r\n        fc.value = \"+\" + sys.getValue(type);\r\n        let cost = sys.getCost(type);\r\n        let costType = sys.getCostType(type);\r\n        let have = Session.homeData.getGoldByType(costType);\r\n        let can = (have >= cost);\r\n        btn.visible = can;\r\n        box.visible = !can;\r\n        let sysRB = SysRoleBase.getSys(this.nowRoleId);\r\n        let v = sysRB.getValue(type);\r\n        allFc.value = (v + sys.getValue(type)) + \"\";\r\n        if (box.visible == false) {\r\n            return;\r\n        }\r\n        fc2.value = (have + \"/\" + cost);\r\n        let vv = (have / cost);\r\n        tiao.scrollRect = new Laya.Rectangle(0, 0, tiao.width * vv, tiao.height);\r\n        tiao.visible = (vv != 0);\r\n    }\r\n}\r\n",
  "references": [
    "D:/game01/Layabox/Game3DUP/src/ui/layaMaxUI.ts",
    "D:/game01/Layabox/Game3DUP/src/main/Session.ts",
    "D:/game01/Layabox/Game3DUP/src/main/sys/SysRoleUp.ts",
    "D:/game01/Layabox/Game3DUP/src/game/data/HeroData.ts",
    "D:/game01/Layabox/Game3DUP/src/main/sys/SysRolebase.ts",
    "D:/game01/Layabox/Game3DUP/src/core/App.ts",
    "D:/game01/Layabox/Game3DUP/src/main/dialog/AdDiamond.ts",
    "D:/game01/Layabox/Game3DUP/src/core/utils/AutoEvent.ts",
    "D:/game01/Layabox/Game3DUP/src/main/GameEvent.ts",
    "D:/game01/Layabox/Game3DUP/src/main/sys/SysSkill.ts",
    "D:/game01/Layabox/Game3DUP/src/game/data/HomeData.ts"
  ]
}

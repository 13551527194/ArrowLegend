{
  "code": "import App from \"../../core/App\";\r\nimport SysTalentInfo from \"../../main/sys/SysTalentInfo\";\r\nimport GameEvent from \"../../main/GameEvent\";\r\nimport Session from \"../../main/Session\";\r\nimport { GoldType } from \"./HomeData\";\r\nimport SysTalentCost from \"../../main/sys/SysTalentCost\";\r\nimport Equip from \"./Equip\";\r\nexport default class TalentData {\r\n    constructor() {\r\n        this.talentArr = [];\r\n        this.lvTimes = 0;\r\n        this.equip = new Equip();\r\n        this.imgArr = [];\r\n        this.addData(\"tianfu/PTkuang.png\", \"tianfu/gongji.png\", \"tianfu/gongzi.png\", 1);\r\n        this.addData(\"tianfu/PTkuang.png\", \"tianfu/shengming.png\", \"tianfu/shengzi.png\", 2);\r\n        this.addData(\"tianfu/PTkuang.png\", \"tianfu/shengming.png\", \"tianfu/shengzi.png\", 3);\r\n        this.addData(\"tianfu/JYkuang.png\", \"tianfu/fangyu.png\", \"tianfu/fangzi.png\", 4);\r\n        this.addData(\"tianfu/JYkuang.png\", \"tianfu/gongji.png\", \"tianfu/gongzi.png\", 5);\r\n        this.addData(\"tianfu/JYkuang.png\", \"tianfu/jinbi.png\", \"tianfu/diaozi.png\", 6);\r\n        this.addData(\"tianfu/SSkuang.png\", \"tianfu/baoji.png\", \"tianfu/baozi.png\", 7);\r\n        this.addData(\"tianfu/SSkuang.png\", \"tianfu/lixian.png\", \"tianfu/lizi.png\", 8);\r\n        this.addData(\"tianfu/SSkuang.png\", \"tianfu/tiejiang.png\", \"tianfu/tiezi.png\", 9);\r\n    }\r\n    addData(bg, logo, font, id) {\r\n        this.imgArr.push({ bg: bg, logo: logo, font: font, id: id });\r\n    }\r\n    getImgData(id) {\r\n        return this.imgArr[id - 1];\r\n    }\r\n    setData(data) {\r\n        if (data.talent == null) {\r\n            this.initData(data);\r\n        }\r\n        let arr = data.talent.split(\",\");\r\n        for (let k of arr) {\r\n            this.talentArr.push(parseInt(k));\r\n        }\r\n    }\r\n    saveData(data) {\r\n        data.talent = this.talentArr.join(\",\");\r\n    }\r\n    initData(data) {\r\n        let sysArr = App.tableManager.getTable(SysTalentInfo.NAME);\r\n        for (let k of sysArr) {\r\n            this.talentArr.push(0);\r\n        }\r\n    }\r\n    getLv(id) {\r\n        return this.talentArr[id - 1];\r\n    }\r\n    getTxt(index) {\r\n        return \"\";\r\n    }\r\n    setView(v, id) {\r\n    }\r\n    lvUp(id) {\r\n        let res = this.canLvUp();\r\n        if (res != 0) {\r\n            return res;\r\n        }\r\n        this.lvTimes++;\r\n        let sys = App.tableManager.getDataByNameAndId(SysTalentCost.NAME, (this.lvTimes + 1));\r\n        Session.homeData.changeGold(GoldType.GOLD, -sys.talentCost);\r\n        this.talentArr[id - 1] = this.getLv(id) + 1;\r\n        App.sendEvent(GameEvent.TALENT_UPDATE);\r\n        Session.saveData();\r\n        return res;\r\n    }\r\n    haveGold() {\r\n        let g = Session.homeData.getGoldByType(GoldType.GOLD);\r\n        let sys = App.tableManager.getDataByNameAndId(SysTalentCost.NAME, (this.lvTimes + 1));\r\n        return g >= sys.talentCost;\r\n    }\r\n    canLvUp() {\r\n        if (this.haveGold() == false) {\r\n            return -1;\r\n        }\r\n        if (this.lvTimes > Session.homeData.level) {\r\n            return -2;\r\n        }\r\n        return 0;\r\n    }\r\n}\r\n",
  "references": [
    "D:/gitworker/Game3DUP/src/game/data/IData.ts",
    "D:/gitworker/Game3DUP/src/core/App.ts",
    "D:/gitworker/Game3DUP/src/main/sys/SysTalentInfo.ts",
    "D:/gitworker/Game3DUP/src/main/GameEvent.ts",
    "D:/gitworker/Game3DUP/src/main/Session.ts",
    "D:/gitworker/Game3DUP/src/game/data/HomeData.ts",
    "D:/gitworker/Game3DUP/src/main/sys/SysTalentCost.ts",
    "D:/gitworker/Game3DUP/src/game/data/Equip.ts",
    "D:/gitworker/Game3DUP/src/ui/layaMaxUI.ts"
  ]
}

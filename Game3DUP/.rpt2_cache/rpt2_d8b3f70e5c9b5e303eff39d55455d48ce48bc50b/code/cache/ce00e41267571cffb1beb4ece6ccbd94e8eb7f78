{
  "code": "import { ui } from \"../../../../ui/layaMaxUI\";\r\nimport App from \"../../../../core/App\";\r\nimport SysTalentInfo from \"../../../sys/SysTalentInfo\";\r\nimport Session from \"../../../Session\";\r\nimport GameEvent from \"../../../GameEvent\";\r\nimport SelectTalent from \"./SelectTalent\";\r\nimport TalentCell2 from \"./TalentCell2\";\r\nexport default class TalentView extends ui.test.talentUI {\r\n    constructor() {\r\n        super();\r\n        this.height = Laya.stage.height;\r\n        this.width = Laya.stage.width;\r\n        this.list.itemRender = TalentCell2;\r\n        this.on(Laya.Event.DISPLAY, this, this.disFun);\r\n        this.shengmingniu.clickHandler = new Laya.Handler(this, this.btnFun);\r\n        Laya.stage.on(GameEvent.TALENT_UPDATE, this, this.tFun);\r\n        this.list.renderHandler = new Laya.Handler(this, this.renderFun);\r\n    }\r\n    selectFun(index) {\r\n        console.log(index);\r\n        if (index == -1) {\r\n            this.tipBox.visible = false;\r\n            return;\r\n        }\r\n        let lv = Session.talentData.getLv(index + 1);\r\n        this.tipBox.visible = true;\r\n        let b = this.list.getCell(index);\r\n        this.tipBox.x = this.list.x + b.x - 130;\r\n        this.tipBox.y = this.list.y + b.y + 200;\r\n        let sys = App.tableManager.getDataByNameAndId(SysTalentInfo.NAME, index + 1);\r\n        this.txt5.text = sys.talentInfo + \":\" + Session.talentData.getTxt(index) + \"%\";\r\n    }\r\n    renderFun(cell, index) {\r\n        let sys = this.list.getItem(index);\r\n        let obj = Session.talentData.getImgData(sys.id);\r\n        cell.logo1.skin = obj.logo;\r\n        cell.bg1.skin = obj.bg;\r\n        cell.txtImg.skin = obj.font;\r\n        let lv = Session.talentData.getLv(sys.id);\r\n        cell.lv.value = lv + \"\";\r\n        cell.box1.visible = cell.box2.visible = false;\r\n        if (lv == 0) {\r\n            cell.box2.visible = true;\r\n        }\r\n        else {\r\n            cell.box1.visible = true;\r\n        }\r\n        cell.select.visible = (this.list.selectedIndex == index);\r\n        cell.on(Laya.Event.CLICK, this, this.cellClickFun, [cell, index]);\r\n    }\r\n    cellClickFun(cell, index) {\r\n        if (index == -1) {\r\n            this.tipBox.visible = false;\r\n            return;\r\n        }\r\n        let lv = Session.talentData.getLv(index + 1);\r\n        if (lv == 0) {\r\n            this.tipBox.visible = false;\r\n        }\r\n        else {\r\n            this.tipBox.visible = true;\r\n            this.tipBox.x = this.list.x + cell.x - 60;\r\n            this.tipBox.y = this.list.y + cell.y + 200;\r\n            let sys = App.tableManager.getDataByNameAndId(SysTalentInfo.NAME, index + 1);\r\n            this.txt5.text = sys.talentInfo + \":\" + Session.talentData.getTxt(index) + \"%\";\r\n        }\r\n    }\r\n    tFun() {\r\n        this.refresh();\r\n    }\r\n    btnFun() {\r\n        let d = new SelectTalent();\r\n        d.popup(false);\r\n    }\r\n    disFun() {\r\n        this.tipBox.visible = false;\r\n        this.refresh();\r\n    }\r\n    refresh() {\r\n        let sysArr = App.tableManager.getTable(SysTalentInfo.NAME);\r\n        this.list.array = sysArr;\r\n        this.shengmingniu.disabled = !Session.talentData.haveGold();\r\n    }\r\n    effect() {\r\n        this.list.mouseEnabled = false;\r\n        let len = this.list.cells.length;\r\n        for (let i = 0; i < len; i++) {\r\n            this.tw(this.list.cells[i], i * 100);\r\n        }\r\n        Laya.timer.once(len * 100 + 800, this, this.mouseFun);\r\n    }\r\n    mouseFun() {\r\n        this.list.mouseEnabled = true;\r\n    }\r\n    tw(cell, delay) {\r\n        let t = new Laya.Tween();\r\n        t.from(cell, { y: cell.y + this.list.height - cell.height }, 800 + delay, Laya.Ease.backIn, null);\r\n    }\r\n}\r\n",
  "references": [
    "D:/gitworker/Game3DUP/src/ui/layaMaxUI.ts",
    "D:/gitworker/Game3DUP/src/main/scene/main/talent/TalentCell.ts",
    "D:/gitworker/Game3DUP/src/core/App.ts",
    "D:/gitworker/Game3DUP/src/main/sys/SysTalentInfo.ts",
    "D:/gitworker/Game3DUP/src/main/Session.ts",
    "D:/gitworker/Game3DUP/src/main/FlyUpTips.ts",
    "D:/gitworker/Game3DUP/src/main/GameEvent.ts",
    "D:/gitworker/Game3DUP/src/game/data/HomeData.ts",
    "D:/gitworker/Game3DUP/src/main/sys/SysTalentCost.ts",
    "D:/gitworker/Game3DUP/src/main/scene/main/talent/SelectTalent.ts",
    "D:/gitworker/Game3DUP/src/main/scene/main/talent/TalentCell2.ts"
  ]
}

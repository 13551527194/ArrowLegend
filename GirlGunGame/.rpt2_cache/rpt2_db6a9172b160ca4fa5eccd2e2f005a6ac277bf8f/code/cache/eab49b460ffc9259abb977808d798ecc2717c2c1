{
  "code": "import { ui } from \"../../../../ui/layaMaxUI\";\r\nimport SysChapter from \"../../../sys/SysChapter\";\r\nimport GameEvent from \"../../../GameEvent\";\r\nimport Game from \"../../../../game/Game\";\r\nimport Session from \"../../../Session\";\r\nimport FlyUpTips from \"../../../FlyUpTips\";\r\nimport SysMap from \"../../../sys/SysMap\";\r\nimport Hero from \"../../../../game/player/Hero\";\r\nimport MyEffect from \"../../../../core/utils/MyEffect\";\r\nexport default class WorldCell extends ui.test.worldCellUI {\r\n    constructor() {\r\n        super();\r\n        this.sys1 = null;\r\n        this.clickBox.on(Laya.Event.CLICK, this, this.onClick);\r\n        this.suo.visible = false;\r\n        WorldCell.clickCell = this;\r\n    }\r\n    onClick() {\r\n        WorldCell.clickCell = this;\r\n        if (!this.suo.visible) {\r\n            Game.battleLoader.chapterId = this.sys.id;\r\n            SysChapter.randomDiamond(Game.battleLoader.chapterId);\r\n            Game.battleCoins = 0;\r\n            Game.battleExp = Game.heroExp = 0;\r\n            Hero.udpateHeroData();\r\n            MyEffect.scaleEffect(this.mapBtn);\r\n            Laya.stage.event(GameEvent.START_BATTLE);\r\n        }\r\n        else {\r\n            FlyUpTips.setTips(\"未开启\");\r\n        }\r\n    }\r\n    update(sysChapter, force = false) {\r\n        this.sys1 = sysChapter;\r\n        if (sysChapter == null) {\r\n            this.openBox.visible = false;\r\n            this.noOpenImg.visible = true;\r\n            this.titleTxt.skin = \"chapters/wait_title.png\";\r\n            return;\r\n        }\r\n        else {\r\n            this.openBox.visible = true;\r\n            this.noOpenImg.visible = false;\r\n        }\r\n        this.sys = sysChapter;\r\n        this.suo.visible = Session.homeData.chapterId < sysChapter.id;\r\n        if (force) {\r\n            this.suo.visible = false;\r\n        }\r\n        this.mapBtn.gray = this.suo.visible;\r\n        this.cengshuTxt.text = \"\";\r\n        this.titleTxt.skin = \"chapters/chapter_title_\" + this.sys.id + \".png\";\r\n        this.mapBtn.skin = \"chapters/chapter_img_\" + this.sys.id + \".png\";\r\n        this.box1.visible = !this.suo.visible;\r\n        if (!this.suo.visible) {\r\n            let maxCeng = SysMap.getTotal(this.sys.id);\r\n            if (sysChapter.id == Session.homeData.chapterId) {\r\n                this.cengshuTxt.text = \"最高层数:\" + Session.homeData.mapIndex + \"/\" + maxCeng;\r\n            }\r\n            else {\r\n                this.cengshuTxt.text = \"最高层数:\" + maxCeng + \"/\" + maxCeng;\r\n            }\r\n        }\r\n    }\r\n    open() {\r\n        let t = new Laya.Tween();\r\n        t.to(this.suo, { scaleX: 5, scaleY: 5, alpha: 0 }, 600, null, new Laya.Handler(this, this.comfun));\r\n    }\r\n    comfun() {\r\n        this.update(this.sys1);\r\n    }\r\n}\r\nWorldCell.clickCell = null;\r\n",
  "references": [
    "D:/gitworker/GirlGunGame/src/ui/layaMaxUI.ts",
    "D:/gitworker/GirlGunGame/src/main/sys/SysChapter.ts",
    "D:/gitworker/GirlGunGame/src/main/GameEvent.ts",
    "D:/gitworker/GirlGunGame/src/game/Game.ts",
    "D:/gitworker/GirlGunGame/src/main/Session.ts",
    "D:/gitworker/GirlGunGame/src/main/FlyUpTips.ts",
    "D:/gitworker/GirlGunGame/src/main/sys/SysMap.ts",
    "D:/gitworker/GirlGunGame/src/game/player/Hero.ts",
    "D:/gitworker/GirlGunGame/src/core/utils/MyEffect.ts",
    "D:/gitworker/GirlGunGame/src/core/App.ts",
    "D:/gitworker/GirlGunGame/src/core/manager/LogType.ts"
  ]
}

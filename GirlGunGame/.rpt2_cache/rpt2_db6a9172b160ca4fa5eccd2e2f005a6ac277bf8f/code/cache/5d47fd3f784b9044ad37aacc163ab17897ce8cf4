{
  "code": "import { ui } from \"./../ui/layaMaxUI\";\r\nimport LoginHttp from \"../net/LoginHttp\";\r\nimport ReceiverHttp from \"../net/ReceiverHttp\";\r\nimport GameMain from \"./GameMain\";\r\nimport App from \"../core/App\";\r\nimport PlatformID from \"../platforms/PlatformID\";\r\nimport Game from \"../game/Game\";\r\nimport CookieKey from \"../gameCookie/CookieKey\";\r\nexport default class HomeLoading extends ui.game.homePageUI {\r\n    constructor() {\r\n        super();\r\n        this.isInit = false;\r\n        this.name = \"HomeLoading\";\r\n        this.mouseEnabled = true;\r\n        this.rect = new Laya.Rectangle(0, 0, 1, this.barImg.height);\r\n        this.on(Laya.Event.DISPLAY, this, this.onDis);\r\n    }\r\n    onDis() {\r\n        this.loadingBox.visible = false;\r\n        this.startBtn.visible = true;\r\n        this.idTxt.visible = (App.platformId == PlatformID.TEST || App.platformId == PlatformID.H5);\r\n        Game.cookie.getCookie(CookieKey.USER_ID, (res) => {\r\n            if (res == null) {\r\n            }\r\n            else {\r\n                App.soundManager.setMusicVolume(res.state);\r\n                this.idTxt.text = res.userId;\r\n            }\r\n        });\r\n    }\r\n    load() {\r\n        this.loadingBox.visible = true;\r\n        this.startBtn.visible = false;\r\n        this.barImg.scrollRect = this.rect;\r\n        this.sliderImg.x = this.rect.width;\r\n        this.txt.text = \"0%\";\r\n        Laya.loader.load([\"res/atlas/main.atlas\", \"res/atlas/zhaohuan.atlas\", \"res/atlas/guide.atlas\"], new Laya.Handler(this, this.onHandler), new Laya.Handler(this, this.onProgress));\r\n    }\r\n    onHandler() {\r\n        console.log(\"加载完成\");\r\n        new LoginHttp(new Laya.Handler(this, this.onSuccess)).checkLogin();\r\n    }\r\n    onSuccess(data) {\r\n        console.log(\"登录成功\");\r\n        ReceiverHttp.create(new Laya.Handler(this, this.onReceive)).send();\r\n    }\r\n    onReceive(data) {\r\n        if (this.isInit) {\r\n            return;\r\n        }\r\n        console.log(\"获取玩家数据成功\" + data);\r\n        this.isInit = true;\r\n        new GameMain();\r\n        setTimeout(() => {\r\n            this.removeSelf();\r\n        }, 300);\r\n    }\r\n    onProgress(value) {\r\n        this.rect.width = this.barImg.width * value;\r\n        this.barImg.scrollRect = this.rect;\r\n        this.sliderImg.x = this.rect.width;\r\n        value = value * 100;\r\n        this.txt.text = \"\" + value.toFixed(0) + \"%\";\r\n    }\r\n}\r\n",
  "references": [
    "D:/gitworker/GirlGunGame/src/ui/layaMaxUI.ts",
    "D:/gitworker/GirlGunGame/src/net/LoginHttp.ts",
    "D:/gitworker/GirlGunGame/src/net/ReceiverHttp.ts",
    "D:/gitworker/GirlGunGame/src/main/GameMain.ts",
    "D:/gitworker/GirlGunGame/src/core/App.ts",
    "D:/gitworker/GirlGunGame/src/platforms/PlatformID.ts",
    "D:/gitworker/GirlGunGame/src/game/Game.ts",
    "D:/gitworker/GirlGunGame/src/gameCookie/CookieKey.ts"
  ]
}

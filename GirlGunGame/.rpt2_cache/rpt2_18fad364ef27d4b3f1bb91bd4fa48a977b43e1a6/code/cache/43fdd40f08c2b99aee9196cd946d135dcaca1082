{
  "code": "import App from \"../../core/App\";\r\nimport SysMap from \"./SysMap\";\r\nexport default class SysChapter {\r\n    constructor() {\r\n        this.id = 0;\r\n        this.stageName = '';\r\n        this.stageImage = '';\r\n        this.beforeId = 0;\r\n        this.npcDamagescale = 0;\r\n        this.npcHealthscale = 0;\r\n        this.description = 0;\r\n        this.blueDiamond = '';\r\n        this.redDiamond = '';\r\n    }\r\n    static randomDiamond(chapterId) {\r\n        let totolNum = SysMap.getTotal(chapterId);\r\n        SysChapter.dropIndex = Math.ceil(totolNum * Math.random());\r\n        console.log(\"钻石掉落的关卡数\", SysChapter.dropIndex);\r\n        let sys = App.tableManager.getDataByNameAndId(SysChapter.NAME, chapterId);\r\n        let blueArr = sys.blueDiamond.split(',');\r\n        let blueRate = Number(blueArr[0]);\r\n        let blueNum = Number(blueArr[1]);\r\n        let redArr = sys.redDiamond.split(',');\r\n        let redRate = Number(redArr[0]);\r\n        let redNum = Number(redArr[1]);\r\n        let nullRate = 1000 - blueRate - redRate;\r\n        blueRate = blueRate / 1000 * 360;\r\n        redRate = redRate / 1000 * 360;\r\n        nullRate = nullRate / 1000 * 360;\r\n        let rand = Math.random();\r\n        rand = rand * 360;\r\n        SysChapter.blueNum = SysChapter.redNum = 0;\r\n        if (rand <= blueRate && blueRate >= 0) {\r\n            SysChapter.blueNum = blueNum;\r\n            console.log(\"掉落蓝钻\", SysChapter.blueNum);\r\n        }\r\n        else if (rand > blueRate && rand <= blueRate + redRate) {\r\n            SysChapter.redNum = redNum;\r\n            console.log(\"掉落红钻\", SysChapter.redNum);\r\n        }\r\n        SysChapter.heartIndex = -1;\r\n        let heartRate = 1 - Math.random();\r\n        if (heartRate >= 0.1) {\r\n            SysChapter.heartIndex = Math.ceil(totolNum * Math.random());\r\n            SysChapter.heartNum = 1;\r\n            console.log(\"红心掉落的关卡\", SysChapter.heartIndex);\r\n        }\r\n    }\r\n}\r\nSysChapter.NAME = 'sys_stagemap.txt';\r\nSysChapter.heartIndex = -1;\r\n",
  "references": [
    "D:/GirlGunGame/GirlGunGame/src/core/App.ts",
    "D:/GirlGunGame/GirlGunGame/src/main/sys/SysMap.ts"
  ]
}

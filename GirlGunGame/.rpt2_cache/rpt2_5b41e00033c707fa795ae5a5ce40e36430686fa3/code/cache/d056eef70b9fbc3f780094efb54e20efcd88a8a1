{
  "code": "import GamePro from \"../GamePro\";\r\nimport Game from \"../Game\";\r\nimport { ui } from \"./../../ui/layaMaxUI\";\r\nimport FootRotateScript from \"../controllerScript/FootRotateScript\";\r\nimport GameBG from \"../GameBG\";\r\nimport CoinsAI from \"../ai/CoinsAI\";\r\nimport CoinsMove from \"../move/CoinsMove\";\r\nimport GameHitBox from \"../GameHitBox\";\r\nimport SysChapter from \"../../main/sys/SysChapter\";\r\nimport Session from \"../../main/Session\";\r\nimport SysItem from \"../../main/sys/SysItem\";\r\nimport App from \"../../core/App\";\r\nexport default class Coin extends GamePro {\r\n    constructor() {\r\n        super(0, 1);\r\n        this.curLen = 0;\r\n        this.moveLen = 0;\r\n        this.status = 0;\r\n        this.setSpeed(0);\r\n        this.setGameAi(new CoinsAI());\r\n        this.setGameMove(new CoinsMove());\r\n        this._bulletShadow = new ui.test.BulletShadowUI();\r\n        Game.footLayer.addChild(this._bulletShadow);\r\n        this.setShadowSize(20);\r\n    }\r\n    static getOne(id) {\r\n        let coin = Laya.Pool.getItemByClass(Coin.TAG + id, Coin);\r\n        coin.id = id;\r\n        if (!coin.sp3d) {\r\n            var sp;\r\n            sp = Laya.Sprite3D.instantiate(Laya.loader.getRes(\"h5/coins/\" + id + \"/monster.lh\"));\r\n            coin.setSp3d(sp);\r\n            if (id == Coin.TYPE_COIN) {\r\n                coin.sp3d.transform.localScale = Coin.tScale;\r\n            }\r\n            else {\r\n                coin.sp3d.transform.localScale = Coin.tScale2;\r\n            }\r\n            if (sp) {\r\n                coin.sp3d.addComponent(FootRotateScript);\r\n            }\r\n        }\r\n        return coin;\r\n    }\r\n    setPos(monster, r, id) {\r\n        this.status = 1;\r\n        this.curLen = 0;\r\n        if (id == Coin.TYPE_COIN) {\r\n            this.moveLen = 20 + Math.random() * GameBG.ww;\r\n        }\r\n        else if (id == Coin.TYPE_HEART) {\r\n            this.moveLen = Math.random() * GameBG.ww;\r\n        }\r\n        else {\r\n            this.moveLen = 50 + Math.random() * GameBG.ww;\r\n        }\r\n        this.setXY2D(monster.pos2.x, monster.pos2.z);\r\n        this.setSpeed(2);\r\n        this.rotation(r);\r\n        this.startAi();\r\n        Game.layer3dCoins.addChild(this.sp3d);\r\n        Game.footLayer.addChild(this._bulletShadow);\r\n    }\r\n    updateUI() {\r\n        super.updateUI();\r\n        this._bulletShadow && this._bulletShadow.pos(this.hbox.cx + 10, this.hbox.cy + 10);\r\n    }\r\n    onCom() {\r\n        this.setShadowSize(20);\r\n        let xx = GameBG.ww * this.sp3d.transform.localPositionX;\r\n        let yy = GameBG.ww * this.sp3d.transform.localPositionZ * Game.cameraCN.cos0;\r\n        this.setXY2D(xx, yy);\r\n        this._bulletShadow && this._bulletShadow.pos(this.hbox.cx + 10, this.hbox.cy);\r\n    }\r\n    fly() {\r\n        var a = GameHitBox.faceTo3D(this.hbox, Game.hero.hbox);\r\n        this.rotation(a);\r\n        this.status = 2;\r\n        this.curLen = 0;\r\n        this.moveLen = 0;\r\n        this._bulletShadow && this._bulletShadow.removeSelf();\r\n        this.setSpeed(GameBG.ww * 0.5);\r\n    }\r\n    clear() {\r\n        this._bulletShadow && this._bulletShadow.removeSelf();\r\n        this.stopAi();\r\n        this.sp3d && this.sp3d.removeSelf();\r\n        if (this.id == Coin.TYPE_COIN) {\r\n            Game.showCoinsNum += 2;\r\n            Laya.stage.event(Game.Event_COINS);\r\n        }\r\n        else if (this.id == Coin.TYPE_BLUE) {\r\n            Game.showBlueNum++;\r\n            SysChapter.blueNum--;\r\n        }\r\n        else if (this.id == Coin.TYPE_RED) {\r\n            Game.showRedNum++;\r\n            SysChapter.redNum--;\r\n        }\r\n        else if (this.id == Coin.TYPE_HEART) {\r\n            let sys = App.tableManager.getDataByNameAndId(SysItem.NAME, Coin.TYPE_HEART);\r\n            let addValue = sys.addHp + Session.talentData.addItemhp;\r\n            Game.hero.addBlood(addValue);\r\n            SysChapter.heartNum--;\r\n        }\r\n        this.curLen = 0;\r\n        this.moveLen = 0;\r\n        this.status = 0;\r\n        if (SysChapter.blueNum <= 0 && SysChapter.redNum <= 0) {\r\n            SysChapter.dropIndex = -1;\r\n        }\r\n        if (SysChapter.heartNum <= 0) {\r\n            SysChapter.heartIndex = -1;\r\n        }\r\n        Laya.Pool.recover(Coin.TAG, this);\r\n    }\r\n}\r\nCoin.TYPE_COIN = 1001;\r\nCoin.TYPE_BLUE = 1002;\r\nCoin.TYPE_RED = 1003;\r\nCoin.TYPE_HEART = 1004;\r\nCoin.TAG = \"Coin\";\r\nCoin.tScale = new Laya.Vector3(1.5, 1.5, 1.5);\r\nCoin.tScale2 = new Laya.Vector3(0.5, 0.5, 0.5);\r\n",
  "references": [
    "D:/GirlGunGame/GirlGunGame/src/game/GamePro.ts",
    "D:/GirlGunGame/GirlGunGame/src/game/GameProType.ts",
    "D:/GirlGunGame/GirlGunGame/src/game/Game.ts",
    "D:/GirlGunGame/GirlGunGame/src/game/player/Monster.ts",
    "D:/GirlGunGame/GirlGunGame/src/ui/layaMaxUI.ts",
    "D:/GirlGunGame/GirlGunGame/src/game/controllerScript/FootRotateScript.ts",
    "D:/GirlGunGame/GirlGunGame/src/game/GameBG.ts",
    "D:/GirlGunGame/GirlGunGame/src/game/ai/CoinsAI.ts",
    "D:/GirlGunGame/GirlGunGame/src/game/move/CoinsMove.ts",
    "D:/GirlGunGame/GirlGunGame/src/game/GameHitBox.ts",
    "D:/GirlGunGame/GirlGunGame/src/main/sys/SysChapter.ts",
    "D:/GirlGunGame/GirlGunGame/src/main/Session.ts",
    "D:/GirlGunGame/GirlGunGame/src/main/sys/SysItem.ts",
    "D:/GirlGunGame/GirlGunGame/src/core/App.ts"
  ]
}

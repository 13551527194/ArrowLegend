{
  "code": "import { ui } from \"../../../../ui/layaMaxUI\";\r\nimport Session from \"../../../Session\";\r\nimport MyEffect from \"../../../../core/utils/MyEffect\";\r\nimport App from \"../../../../core/App\";\r\nimport SysTalentInfo from \"../../../sys/SysTalentInfo\";\r\nimport SysTalent from \"../../../sys/SysTalent\";\r\nimport GuideManager, { Guide_Type } from \"../../../guide/GuideManager\";\r\nimport Game from \"../../../../game/Game\";\r\nexport default class SelectTalent extends ui.test.TalentViewUI {\r\n    constructor() {\r\n        super();\r\n        this.arr = [];\r\n        this.height = Laya.stage.height;\r\n        this.arr.push(this.b0, this.b1, this.b2, this.b3, this.b4, this.b5);\r\n        for (let k of this.arr) {\r\n            k.wenhao.box1.visible = false;\r\n            k.wenhao.select.visible = false;\r\n            k.back.select.visible = false;\r\n            k.back.box2.visible = false;\r\n            k.back.lvBox.visible = false;\r\n            k.on(Laya.Event.CLICK, this, this.clickFun, [k]);\r\n        }\r\n        this.nameImg.alpha = 0;\r\n        this.clickClose.alpha = 0;\r\n        this.box1.visible = false;\r\n        if (Session.homeData.newStat == Guide_Type.select_talent) {\r\n            GuideManager.getInstance().hand(this.b1, this.b1.width / 2, this.b1.height / 2 + 10, Guide_Type.open_role, 400, true);\r\n        }\r\n    }\r\n    tFun() {\r\n    }\r\n    clickFun(e) {\r\n        Game.playSound(\"fx_card.wav\");\r\n        let now = Math.floor(Math.random() * 9) + 1;\r\n        if (Session.homeData.newStat == 4) {\r\n            now = 1;\r\n        }\r\n        let tid = now;\r\n        let obj = Session.talentData.getImgData(now);\r\n        e.back.logo1.skin = obj.logo;\r\n        e.back.bg1.skin = obj.bg;\r\n        e.back.txtImg.skin = obj.font;\r\n        let lv = Session.talentData.getLv(now);\r\n        let oldLv = lv;\r\n        let newLv = lv + 1;\r\n        e.back.lv.value = (lv + 1) + \"\";\r\n        Session.talentData.lvUp(now);\r\n        e.back.select.visible = true;\r\n        this.mouseEnabled = false;\r\n        let t = new Laya.Tween();\r\n        t.to(e, { scaleX: -1, update: new Laya.Handler(this, this.upFun, [e]) }, 600);\r\n        for (let a of this.arr) {\r\n            a.mouseEnabled = false;\r\n            if (a != e) {\r\n                a.back.visible = false;\r\n                MyEffect.hide(a);\r\n            }\r\n        }\r\n        let ty = this.arr[1].y - 100;\r\n        let tx = this.arr[1].x;\r\n        let tw = new Laya.Tween();\r\n        tw.to(e, { x: tx, y: ty }, 800, Laya.Ease.strongOut);\r\n        this.nameImg.skin = e.back.txtImg.skin;\r\n        this.nameImg.y = ty - 200;\r\n        this.l1.visible = false;\r\n        MyEffect.show(this.nameImg);\r\n        this.clickClose.alpha = 1;\r\n        MyEffect.flash(this.clickClose);\r\n        this.timer.once(1000, this, this.timeFun);\r\n        let sysInfo = App.tableManager.getDataByNameAndId(SysTalentInfo.NAME, tid);\r\n        this.l11.text = sysInfo.talentInfo;\r\n        let oldSys = App.tableManager.getDataByNameAndId(SysTalent.NAME, oldLv);\r\n        let newSys = App.tableManager.getDataByNameAndId(SysTalent.NAME, newLv);\r\n        let hou = \"%\";\r\n        if (sysInfo.talentType == 1) {\r\n            hou = \"\";\r\n        }\r\n        else if (sysInfo.talentType == 2) {\r\n            hou = \"%\";\r\n        }\r\n        if (oldSys == null) {\r\n            this.f1.value = \"+0\" + hou;\r\n        }\r\n        else {\r\n            let oldValue = oldSys[sysInfo.idName];\r\n            this.f1.value = \"+\" + oldValue + hou;\r\n        }\r\n        let newValue = newSys[sysInfo.idName];\r\n        this.f2.value = \"+\" + newValue + hou;\r\n        Laya.timer.once(500, this, this.boxFun);\r\n    }\r\n    boxFun() {\r\n        this.box1.visible = true;\r\n        let t3 = new Laya.Tween();\r\n        t3.from(this.box1, { scaleX: 0, scaleY: 0 }, 200, Laya.Ease.backInOut);\r\n    }\r\n    timeFun() {\r\n        Laya.stage.once(Laya.Event.CLICK, this, this.clickFun2);\r\n    }\r\n    clickFun2() {\r\n        this.close();\r\n    }\r\n    upFun(e) {\r\n        if (e.scaleX <= 0) {\r\n            e.wenhao.visible = false;\r\n            e.back.lvBox.visible = true;\r\n        }\r\n    }\r\n}\r\n",
  "references": [
    "D:/GirlGunGame/GirlGunGame/src/ui/layaMaxUI.ts",
    "D:/GirlGunGame/GirlGunGame/src/main/scene/main/talent/TalentCell2.ts",
    "D:/GirlGunGame/GirlGunGame/src/main/Session.ts",
    "D:/GirlGunGame/GirlGunGame/src/core/utils/MyEffect.ts",
    "D:/GirlGunGame/GirlGunGame/src/core/App.ts",
    "D:/GirlGunGame/GirlGunGame/src/main/sys/SysTalentInfo.ts",
    "D:/GirlGunGame/GirlGunGame/src/main/sys/SysTalent.ts",
    "D:/GirlGunGame/GirlGunGame/src/main/guide/GuideManager.ts",
    "D:/GirlGunGame/GirlGunGame/src/game/Game.ts"
  ]
}

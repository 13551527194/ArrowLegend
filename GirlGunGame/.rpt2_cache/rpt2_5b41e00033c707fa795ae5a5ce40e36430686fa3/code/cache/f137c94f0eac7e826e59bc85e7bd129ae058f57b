{
  "code": "export default class FlyEffect {\r\n    constructor() {\r\n        this.flyNum = 30;\r\n        this.flySkin = \"main/jinbi.png\";\r\n        this.flyTargetHandler = null;\r\n        this.x1 = 0;\r\n        this.y1 = 0;\r\n        this.ex = 0;\r\n        this.ey = 0;\r\n        this.goldEvery = 0;\r\n        this.nowGold = 0;\r\n        this.endOffX = 0;\r\n        this.endOffY = 1;\r\n    }\r\n    static getP00() {\r\n        if (FlyEffect.p00Array.length == 0) {\r\n            for (let i = 0; i < 50; i++) {\r\n                let p = new Laya.Point(0, 0);\r\n                FlyEffect.p00Array.push(p);\r\n            }\r\n        }\r\n        if (FlyEffect.p00Index > 49) {\r\n            FlyEffect.p00Index = 0;\r\n        }\r\n        return FlyEffect.p00Array[FlyEffect.p00Index++].setTo(0, 0);\r\n    }\r\n    fly(start, end) {\r\n        this.start = start;\r\n        this.end = end;\r\n        let p = this.start.localToGlobal(new Laya.Point(0, 0));\r\n        this.flyGold(p.x, p.y, 1);\r\n    }\r\n    flyFromP(x1, y1, end, gold, nowGold, fc) {\r\n        this.fc = fc;\r\n        this.end = end;\r\n        this.x1 = x1;\r\n        this.y1 = y1;\r\n        this.nowGold = nowGold;\r\n        let p = end.localToGlobal(new Laya.Point(0, 0));\r\n        this.ex = p.x + this.endOffX;\r\n        this.ey = p.y + this.endOffY;\r\n        this.flyGold(0, 0, gold);\r\n    }\r\n    flyGold(x1, y1, gold) {\r\n        let flyGoldNum = this.flyNum;\r\n        this.goldEvery = gold / flyGoldNum;\r\n        for (let i = 0; i < flyGoldNum; i++) {\r\n            let img = null;\r\n            img = new Laya.Image(this.flySkin);\r\n            Laya.stage.addChild(img);\r\n            img.scaleX = 1;\r\n            img.scaleY = 1;\r\n            img.anchorX = img.anchorY = 0.5;\r\n            img.x = this.x1 + Math.random() * 300 - 150;\r\n            img.y = this.y1 + Math.random() * 100 - 50;\r\n            img.alpha = 0;\r\n            this.flyEffect(img, this.goldEvery);\r\n        }\r\n    }\r\n    flyEffect(img, gold) {\r\n        let p = new Laya.Point(this.x1, this.y1);\r\n        let t = new Laya.Tween();\r\n        let delayTime = Math.random() * 1000;\r\n        t.to(img, { x: this.ex, y: this.ey, scaleX: 0.5, scaleY: 0.5 }, 700, Laya.Ease.backIn, new Laya.Handler(this, this.flyGoldOverFun, [img, gold]), delayTime + 300);\r\n        let t1 = new Laya.Tween();\r\n        img.scaleX = img.scaleY = 0;\r\n        img.alpha = 0.0;\r\n        t1.to(img, { scaleX: 1, scaleY: 1, alpha: 1 }, 300, Laya.Ease.backOut, null, delayTime);\r\n    }\r\n    dFun(img) {\r\n        FlyEffect.BigSmallEffect(img);\r\n    }\r\n    static BigSmallEffect(s) {\r\n        let t = new Laya.Tween();\r\n        s.scaleX = s.scaleY = 0;\r\n        s.alpha = 0.0;\r\n        t.to(s, { scaleX: 1, scaleY: 1, alpha: 1 }, 300, Laya.Ease.backOut);\r\n    }\r\n    flyGoldOverFun(img, gold) {\r\n        img.removeSelf();\r\n        let t = new Laya.Tween();\r\n        t.to(this.end, { scaleX: 0.7, scaleY: 0.7 }, 80);\r\n        let t1 = new Laya.Tween();\r\n        t1.to(this.end, { scaleX: 1, scaleY: 1 }, 60, null, null, 80);\r\n        this.nowGold += gold;\r\n        if (this.flyTargetHandler == null) {\r\n            this.fc.value = parseInt(Math.ceil(this.nowGold) + \"\") + \"\";\r\n        }\r\n        else {\r\n            this.flyTargetHandler.runWith([this.fc, this.nowGold]);\r\n        }\r\n    }\r\n}\r\nFlyEffect.p00Array = [];\r\nFlyEffect.p00Index = 0;\r\n",
  "references": []
}
